# Findora 実装計画

最終更新: 2025-08-02

## フェーズ1: 基本的なファイル検索機能の実装

### 1. バックエンド（Rust）の基盤構築
- **ファイルシステム探索モジュール**
  - [x] `walkdir`クレートを追加してディレクトリの再帰的探索を実装
  - [x] `ignore`クレートで.gitignoreパターンのサポート
  - [x] ファイルメタデータ（作成日時、更新日時、サイズ）の取得

- **テキスト抽出エンジン**
  - [x] プレーンテキスト（.txt, .md）の読み込み
  - [x] 文字エンコーディングの自動検出（encoding_rs）
  - [ ] ファイル内容のインメモリキャッシュ機構

- **検索エンジン**
  - [ ] 基本的な文字列マッチング
  - [ ] 大文字小文字を区別しない検索オプション
  - [x] 検索結果の構造体定義（ファイルパス、マッチ位置、前後のコンテキスト）

### 2. フロントエンド（React）のUI構築
- **検索画面の実装**
  - [ ] 検索ボックスコンポーネント
  - [x] ディレクトリ選択ダイアログ（テキスト入力で実装）
  - [ ] 検索オプション（大文字小文字、ファイルタイプフィルタ）

- **検索結果表示**
  - [x] 結果リストコンポーネント（ファイル名、パス、マッチプレビュー）※プレビューのみ
  - [ ] ページネーション機能
  - [ ] 結果のソート機能（関連度、日付、サイズ）

### 3. Tauri統合
- 検索関連のコマンド実装
  - [ ] `search_files`: ファイル検索実行
  - [ ] `open_file`: 選択したファイルを開く
  - [ ] `get_directory`: ディレクトリ選択ダイアログ
  - [x] `test_scan_directory`: テスト用ディレクトリスキャン
  - [x] `test_read_file`: テスト用ファイル読み取り

## フェーズ2: 高度なファイル形式対応

### 1. Office文書対応
- **DOCX対応**
  - `docx-rs`または`zip` + XMLパーサーでDOCX内容抽出
  - テキストとメタデータの抽出

- **PDF対応**
  - `pdf-extract`または`lopdf`でPDFテキスト抽出
  - 基本的なテキストレイヤーの読み取り

### 2. 検索機能の強化
- **インデックス機能**
  - 初回スキャン時のインデックス作成
  - SQLite（rusqlite）でのインデックス保存
  - 差分更新機能

## フェーズ3: UX改善と最適化

### 1. パフォーマンス最適化
- 並列ファイル処理（rayon）
- ストリーミング検索結果
- メモリ使用量の最適化

### 2. UI/UX改善
- 検索履歴機能
- お気に入りディレクトリ
- ダークモード対応
- 検索結果のハイライト表示

## 技術的な実装詳細

### Rustクレートの追加
```toml
walkdir = "2"
ignore = "0.4"
encoding_rs = "0.8"
rayon = "1.7"
rusqlite = { version = "0.29", features = ["bundled"] }
docx-rs = "0.4"
pdf-extract = "0.7"
```

### モジュール構成
```
src-tauri/src/
├── main.rs
├── lib.rs
├── file_system/
│   ├── mod.rs
│   ├── scanner.rs
│   └── metadata.rs
├── text_extractor/
│   ├── mod.rs
│   ├── plain_text.rs
│   ├── docx.rs
│   └── pdf.rs
├── search/
│   ├── mod.rs
│   ├── engine.rs
│   └── index.rs
└── commands/
    ├── mod.rs
    └── search.rs
```

### Reactコンポーネント構成
```
src/
├── components/
│   ├── SearchBar.tsx
│   ├── SearchResults.tsx
│   ├── FilePreview.tsx
│   └── DirectoryPicker.tsx
├── hooks/
│   ├── useSearch.ts
│   └── useFileSystem.ts
├── types/
│   └── search.ts
└── App.tsx
```

## 実装の優先順位

1. **最初のマイルストーン（MVP）**
   - 基本的なテキストファイル検索
   - シンプルな検索UI
   - ファイルを開く機能

2. **第2マイルストーン**
   - DOCX/PDF対応
   - 検索結果のハイライト
   - 基本的なフィルタリング

3. **第3マイルストーン**
   - インデックス機能
   - パフォーマンス最適化
   - 高度なUI機能

この計画により、段階的にFindoraの機能を実装していきます。各フェーズは独立して動作可能で、ユーザーに価値を提供しながら開発を進められます。